<!DOCTYPE html>
<html lang=en>
<head>
    <meta charset=UTF-8>
    <title>承气运 启盛世 | 东家财富乔迁新址，欢迎莅临</title>
    <meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1,minimum-scale=1,user-scalable=no">
    <link rel=stylesheet type=text/css href='__PUBLIC__/myWeb/Public/Admin/css/reset.css?is=1'>
    <link href="//static.360buyimg.com/static-sale-m/dist/view/css/base.css?t=20171027185038" rel=stylesheet type=text/css>
    <script type=text/config id=jdAppType>jdapp,jdsmart,walletclient,jdcarapp,jdsg</script>
    <script type=text/javascript src="//static.360buyimg.com/static-sale-m/dist/view/lib/common.js?t=20171027185038"></script>
    <script type=text/javascript src="https://res.wx.qq.com/open/js/jweixin-1.3.2.js"></script>
    <script>
      window.browser = {
        versions: function () {
          let u = navigator.userAgent;
          return {
            trident: u.indexOf('Trident') > -1,
            presto: u.indexOf('Presto') > -1,
            webKit: u.indexOf('AppleWebKit') > -1,
            gecko: u.indexOf('Gecko') > -1 && u.indexOf('KHTML') === -1,
            mobile: !!u.match(/AppleWebKit.*Mobile.*/),
            ios: !!u.match(/\(i[^;]+;( U;)? CPU.+Mac OS X/),
            android: u.indexOf('Android') > -1,
            iPhone: u.indexOf('iPhone') > -1,
            iPad: u.indexOf('iPad') > -1,
            jdjr: u.indexOf('JDJR-App') > -1,
            webApp: u.indexOf('Safari') === -1,
            wechat: u.indexOf('MicroMessenger') !== -1
          };
        }(), language: (navigator.browserLanguage || navigator.language).toLowerCase()
      };</script>
    <script>
      function ajax() {
        var ajaxData = {
          type: arguments[0].type || "GET",
          url: arguments[0].url || "",
          async: arguments[0].async || "true",
          data: arguments[0].data || null,
          dataType: arguments[0].dataType || "text",
          contentType: arguments[0].contentType || "application/x-www-form-urlencoded",
          beforeSend: arguments[0].beforeSend || function () {
          },
          success: arguments[0].success || function () {
          },
          error: arguments[0].error || function () {
          }
        };
        ajaxData.beforeSend();
        var xhr = createxmlHttpRequest();
        xhr.responseType = ajaxData.dataType;
        xhr.open(ajaxData.type, ajaxData.url, ajaxData.async);
        xhr.setRequestHeader("Content-Type", ajaxData.contentType);
        xhr.send(convertData(ajaxData.data));
        xhr.onreadystatechange = function () {
          if (xhr.readyState == 4) {
            if (xhr.status == 200) {
              ajaxData.success(xhr.response)
            } else {
              ajaxData.error()
            }
          }
        }
      }
      function createxmlHttpRequest() {
        if (window.ActiveXObject) {
          return new ActiveXObject("Microsoft.XMLHTTP");
        } else if (window.XMLHttpRequest) {
          return new XMLHttpRequest();
        }
      }
      function convertData(data) {
        if (typeof data === 'object') {
          var convertResult = "";
          for (var c in data) {
            convertResult += c + "=" + data[c] + "&";
          }
          convertResult = convertResult.substring(0, convertResult.length - 1)
          return convertResult;
        } else {
          return data;
        }
      }
     </script>

    <style type="text/css">
        body {
            background-color: #ffffff;
            /* background-image: url('https://file.rose52.com/guanjia/activity/0928newdongjia/bg.jpg');
            background-position: center;
            background-size: cover;
            background-repeat: no-repeat; */
        }
        .mainapp {
            width: 100vw;
            height: 100vh;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }

        .mainapp .top {
            width: 94vw;
            display: flex;
            flex-direction: row;
            justify-content: space-between;
            align-items: flex-start;
            margin-top: 3vw;
        }
        .mainapp .top img{
          width: 40%;
        }

        .mainapp .name {
          color: #fffed9;
          margin-top: 71vh;
        }
        .mainapp .name .main {
          font-size: 6vw;
        }
        .mainapp .name .sub {
          font-weight: lighter;
          margin-left: 2vw;
        }

        .mainapp .bottom {
          position:fixed;
          bottom:0px;
          width: 100vw;
          height: 12vw;
          display: flex;
          flex-direction: row;
          justify-content: space-between;
          align-items: center;

        }
        .mainapp .bottom .btn {
          width: 100vw;
          height: 12vw;
          background-color: #c44848;
          color: white;
          display: flex;
          flex-direction: row;
          justify-content: center;
          align-items: center;
        }

        .mainapp .bottom .dlbtn {
          width: 50vw;
          height: 12vw;
          background-color: #c44848;
          color: white;
          display: flex;
          flex-direction: row;
          justify-content: center;
          align-items: center;
          border-right: solid 1px #9e3a3a
        }

        .mainapp .dl {
          position: fixed;
          bottom: 14vw;
          right: 2vw;
          display: flex;
          flex-direction: row;
          justify-content: flex-start;
          align-items: center;
          color: #c44848;
          font-size: 12px
        }
        .mainapp .dl .icon{
          width: 6vw;
          height: 6vw;
          overflow: hidden;
          background-image: url('https://file.rose52.com/guanjia/activity/0928newdongjia/dl.png');
          background-position: center;
          background-size: cover;
          background-repeat: no-repeat;
          margin-left: 1vw;
        }
    </style>
</head>
<body>
<div class="mainapp">
  <!-- <div class="top">
      <img src="https://file.rose52.com/guanjia/activity/0928newdongjia/cf.png">
      <img src="https://file.rose52.com/guanjia/activity/0928newdongjia/hw.png">
  </div>
  <div class="name">
    <span id="main" class="main">京家成员</span>
    <span class="sub">敬邀</span>
  </div> -->
  <canvas style="display:none;" id="can" width="750" height="1334"></canvas>
  <img style="width:100%" id="show" src="https://file.rose52.com/guanjia/activity/0928newdongjia/newdongjia.jpg">
  <div class="bottom">
      <!-- <div class="dlbtn" onclick="download()">保存图片</div> -->
      <div class="btn" onclick="goto()">我也想邀请</div>
  </div>
  <!-- <div class="dl" onclick="download()">保存图片<div class="icon"></div></div> -->
</div>
<script>
  let name = '';
  let main = document.getElementById('main');
  function getRequest(url) {
    url = url ? url : window.location.href;
    if (url.indexOf('?') !== -1) {
      let str = url.substr(url.indexOf('?') + 1);
      let strs = str.split('&');
      let result = {};
      for (let temp of strs) {
        let tp = temp.split('=');
        if (tp[0]) {
          result[tp[0]] = decodeURIComponent(tp[1]);
        }
      }
      return result;
    } else {
      return {};
    }
  }
  let para = getRequest();
  // if (para.aname) {
  //   main.innerText = decodeURIComponent(escape(window.atob(para.aname)));
  // }

  function goto() {
    window.location.href = '/act/makenewdjia';
  }

  function download() {
    window.open('https://file.rose52.com/guanjia/activity/0928newdongjia/newdongjia.jpg');
  }
</script>
  <script>
      var canvas;
      var fd;
      var txt = decodeURIComponent(escape(window.atob(para.aname)));
    window.onload = function() {
      canvas = document.getElementById('can');
      fd = canvas.getContext('2d');
      var bg = new Image();
      bg.src = '/myWeb/Public/file/newdongjia.jpg';
      bg.setAttribute("crossOrigin",'Anonymous');
      bg.onload = function() {
        fd.drawImage(bg,0,0);
      };
  
          fd.fillStyle = '#fffed9';
          fd.font = "400 60px Arial";
          fd.globalCompositeOperation = 'destination-over';
          fd.fillText(txt, 230, 1100);
  
          fd.fillStyle = '#fffed9';
          fd.font = "400 24px Arial";
          fd.globalCompositeOperation = 'destination-over';
          fd.fillText('敬邀', 500, 1100);
    };
  
    function haha() {
      setTimeout(function() {
        canvas = document.getElementById('can');
        fd = canvas.getContext('2d');
        let url = fd.canvas.toDataURL('image/jpeg');
        document.getElementById('show').src=url;
      }, 1000);
    }
    haha();
    </script>
  <script>
  function setShare() {
    if (window.browser.versions.wechat) {
      let optionsWx = {
        url: '/myWeb/AjaxApi/WeChatGuanJia/getJssdkParam',
        type: 'POST',
        data: {
          url: encodeURIComponent(window.location.href)
        },
        success(res) {
          res = JSON.parse(res);
          if (parseInt(res.state) === 1) {
            let data = res.data;
            if (!data.gjEnable) {
              wx.config(data);
              wx.ready(() => {
                wx.onMenuShareAppMessage({
                  title: '承气运 启盛世 | 东家财富乔迁新址，欢迎莅临', // 分享标题
                  link: `${window.location.origin}${window.location.pathname}?aname=${para.aname}`,
                  desc: '上海市黄浦区中山东二路600号BFC外滩金融中心S2 7F',
                  imgUrl: 'https://file.rose52.com/guanjia/activity/0928newdongjia/share.jpg',
                  success: function() {
//                    alert('分享成功');
                  }
                });
                wx.onMenuShareTimeline({
                  title: '承气运 启盛世 | 东家财富乔迁新址，欢迎莅临', // 分享标题
                  link: `${window.location.origin}${window.location.pathname}?aname=${para.aname}`,
                  imgUrl: 'https://file.rose52.com/guanjia/activity/0928newdongjia/share.jpg',
                  success: function () {
                    // 用户确认分享后执行的回调函数
//                    alert('分享成功');
                  },
                  cancel: function () {
                    // 用户取消分享后执行的回调函数
                  }
                });
              });
              wx.error((res) => {
                console.error(res);
//                alert('网络异常，请稍候重试');
              });
            }

          }
        }
      };

      ajax(optionsWx);
    }
  }
  setShare();

</script>
{$jdUnder}
</body>
</html>